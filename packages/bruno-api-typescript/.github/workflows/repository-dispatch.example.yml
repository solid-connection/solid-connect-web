name: Repository Dispatch Method

# ğŸ”„ ë” ëª¨ë“ˆí™”ëœ ë°©ì‹: Bruno ë¦¬í¬ì—ì„œ ì´ë²¤íŠ¸ë§Œ ë³´ë‚´ê³ , í”„ë¡ íŠ¸ì—”ë“œ ë¦¬í¬ì—ì„œ ì²˜ë¦¬
#
# ì´ íŒŒì¼: Bruno ë¦¬í¬ì— ì‚¬ìš©
# í”„ë¡ íŠ¸ì—”ë“œ ë¦¬í¬: frontend-workflow.example.yml ì‚¬ìš©

on:
  push:
    branches:
      - main
    paths:
      - '**.bru'

jobs:
  trigger-frontend:
    runs-on: ubuntu-latest

    steps:
      # GitHub App í† í° ìƒì„±
      - name: Generate GitHub App Token
        id: generate-token
        uses: actions/create-github-app-token@v1
        with:
          app-id: ${{ secrets.APP_ID }}
          private-key: ${{ secrets.APP_PRIVATE_KEY }}
          # âš ï¸ ë³€ê²½ í•„ìš”
          owner: YOUR_GITHUB_USERNAME
          repositories: "YOUR_FRONTEND_REPO"

      # Repository Dispatch ì´ë²¤íŠ¸ ì „ì†¡
      - name: Trigger Frontend Workflow
        run: |
          curl -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ steps.generate-token.outputs.token }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/YOUR_USERNAME/YOUR_FRONTEND_REPO/dispatches \
            -d '{
              "event_type": "bruno_updated",
              "client_payload": {
                "sha": "${{ github.sha }}",
                "ref": "${{ github.ref }}",
                "repository": "${{ github.repository }}",
                "actor": "${{ github.actor }}"
              }
            }'

      - name: Log
        run: |
          echo "âœ… Frontend workflow triggered successfully"
          echo "Repository: YOUR_USERNAME/YOUR_FRONTEND_REPO"
          echo "Event: bruno_updated"
